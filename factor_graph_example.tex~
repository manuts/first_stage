\begin{figure}[htbp]
  \centering
  \begin{subfigure}{0.3\textwidth}
    \includegraphics[scale=0.5]{factor_graph}
  \end{subfigure}
  \begin{subfigure}{0.3\textwidth}
    \includegraphics[scale=0.5]{factor_graph_step1}
  \end{subfigure}
  \begin{subfigure}{0.3\textwidth}
    \includegraphics[scale=0.5]{factor_graph_step2}
  \end{subfigure}
  
  \vspace{1cm}
  
  \begin{subfigure}{0.3\textwidth}
    \includegraphics[scale=0.5]{factor_graph_step3}
  \end{subfigure}
  \begin{subfigure}{0.3\textwidth}
    \includegraphics[scale=0.5]{factor_graph_step4}
  \end{subfigure}
  \begin{subfigure}{0.3\textwidth}
    \includegraphics[scale=0.5]{factor_graph_step5}
  \end{subfigure}
  \caption{Marginalizaion by message passing}\label{fig:fmarginal}
\end{figure}